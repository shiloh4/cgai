
/////////////////////////////////////////////////////
//// CS 8803/4803 CGAI: Computer Graphics in AI Era
//// Assignment 2B: Neural Radiance Fields (NeRF)
/////////////////////////////////////////////////////

precision highp float;              //// set default precision of float variables to high precision

varying vec2 vUv;                   //// screen uv coordinates (varying, from vertex shader)
uniform vec2 iResolution;           //// screen resolution (uniform, from CPU)
uniform float iTime;                //// time elapsed (uniform, from CPU)

#define PI 3.1415925359

// ReLU function
vec4 relu(vec4 x)
{
    return max(x, vec4(0.0));
}

float relu(float x)
{
    return max(0.0, x);
}

// Sigmoid function
float sigmoid(float x)
{
    return 1.0 / (1.0 + exp(-x));
}

vec3 sigmoid(vec3 x)
{
    return 1.0 / (1.0 + exp(-x));
}

//// Replace this with the given hotdog NeRF model or your trained NeRF
vec4 queryNetwork(vec3 p){
    vec4 PE_0 = vec4(p.x,p.y,p.z,sin(1.00*p.x));
    vec4 PE_1 = vec4(sin(1.00*p.y),sin(1.00*p.z),cos(1.00*p.x),cos(1.00*p.y));
    vec4 PE_2 = vec4(cos(1.00*p.z),sin(2.00*p.x),sin(2.00*p.y),sin(2.00*p.z));
    vec4 PE_3 = vec4(cos(2.00*p.x),cos(2.00*p.y),cos(2.00*p.z),sin(4.00*p.x));
    vec4 PE_4 = vec4(sin(4.00*p.y),sin(4.00*p.z),cos(4.00*p.x),cos(4.00*p.y));
    vec4 PE_5 = vec4(cos(4.00*p.z),sin(8.00*p.x),sin(8.00*p.y),sin(8.00*p.z));
    vec4 PE_6 = vec4(cos(8.00*p.x),cos(8.00*p.y),cos(8.00*p.z),sin(16.00*p.x));
    vec4 PE_7 = vec4(sin(16.00*p.y),sin(16.00*p.z),cos(16.00*p.x),cos(16.00*p.y));
    vec4 PE_8 = vec4(cos(16.00*p.z),sin(32.00*p.x),sin(32.00*p.y),sin(32.00*p.z));
    vec4 PE_9 = vec4(cos(32.00*p.x),cos(32.00*p.y),cos(32.00*p.z),0.0);
    
    vec4 f0_0 = relu(
    mat4(.12,-1.16,.36,-.00,-.29,-.20,-.65,-.38,-.25,.25,-.07,-.01,-.11,-.94,.16,.06) * PE_0 +
    mat4(-.00,.16,-.51,-.38,-.10,.22,-.00,-.19,-.12,-.31,-.29,-.34,-.27,.23,-.12,-.11) * PE_1 +
    mat4(-.39,-.04,-.18,-.27,-.08,-.23,.11,.05,-.24,.14,-.18,-.16,-.10,.27,.31,.18) * PE_2 +
    mat4(-.03,-.68,-.11,.08,.36,.58,-.36,.66,-.01,-.79,-.42,-.02,.31,.63,-.19,-.03) * PE_3 +
    mat4(.46,.26,1.28,.35,.75,-.82,1.25,.64,.29,-.34,.15,.53,.42,.17,-.99,.31) * PE_4 +
    mat4(-.08,.17,-.29,-.19,.49,.10,-.64,-.36,.65,.35,-.06,.03,-.24,-.18,.48,.49) * PE_5 +
    mat4(.93,.39,.63,.72,-.73,-.49,.50,-.42,.19,-.56,-.07,.64,.24,.12,.11,-.33) * PE_6 +
    mat4(.88,.42,.04,-.61,-.11,-1.11,.33,-.29,.68,-.57,-.35,.12,-.26,.28,-.33,-.08) * PE_7 +
    mat4(-.29,.58,-.54,-.53,-.42,.16,.33,.09,.60,.10,-.25,-.12,.18,.00,.12,.38) * PE_8 +
    mat4(.46,-.19,-.28,.29,.45,-.11,-.08,.29,.24,.18,.16,.22,.00,.00,.00,.00) * PE_9 + vec4(-.23,-.04,-.10,-.15));
    vec4 f0_1 = relu(
    mat4(.17,.86,.09,-.33,.19,-.10,-.07,.70,-.02,.02,-.08,.02,.12,.68,-.11,-.34) * PE_0 +
    mat4(.08,.11,.10,.40,.23,.19,-.28,-.09,-.25,-.02,-.20,-.02,-.11,-.04,-.18,-.19) * PE_1 +
    mat4(-.30,.09,-.41,-.21,.12,.46,-.15,-.01,.27,.45,.21,.01,.29,.26,-.06,-.57) * PE_2 +
    mat4(.16,-.34,-.27,-.12,.33,-.31,.44,-.10,-.12,.02,-.13,.03,-.07,.08,.07,.63) * PE_3 +
    mat4(.70,-.39,1.28,.93,.72,1.09,.74,-.61,.41,-1.05,.09,-.47,-.07,.42,-.47,.52) * PE_4 +
    mat4(-.56,-.24,-.09,-.05,.23,-.33,.05,-.58,-.98,.17,-.67,-.64,-.03,.40,.75,-.92) * PE_5 +
    mat4(.59,-.67,1.26,-.02,.19,-1.02,-.50,.44,.35,-.55,.35,-.25,.03,.48,.13,.01) * PE_6 +
    mat4(-.44,-.16,.28,-.40,-.01,-.51,-.45,1.10,.18,.90,.87,.60,.47,-.29,.25,.13) * PE_7 +
    mat4(-1.04,.18,-1.11,.80,.00,.30,-.05,.06,-.09,-.23,.15,.10,-.27,-.29,-.21,-.35) * PE_8 +
    mat4(.10,.02,-.43,.19,.21,-.20,-.30,.06,-.02,-.18,-.63,.38,.00,.00,.00,.00) * PE_9 + vec4(-.31,.02,-.27,-.17));
    vec4 f0_2 = relu(
    mat4(.09,-.17,.02,-.14,-.07,.06,-.03,.18,-.05,-.13,-.03,-.11,.06,-.27,.08,.01) * PE_0 +
    mat4(.12,.29,-.02,-.00,.07,-.08,-.07,-.35,-.14,.00,.03,-.05,-.05,-.05,.04,-.13) * PE_1 +
    mat4(-.07,-.13,-.03,-.19,-.14,-.24,.08,.10,.24,.20,-.03,.03,.28,-.07,-.29,-.32) * PE_2 +
    mat4(.01,.34,.03,.02,-.23,.32,.02,.21,.11,.33,.07,.16,-.02,-.34,.12,.31) * PE_3 +
    mat4(-.82,-.64,.48,.24,1.03,.04,-.64,-.33,-.15,.64,.25,.28,-.48,-.00,-.32,.20) * PE_4 +
    mat4(.13,.03,-.19,.18,.15,.10,-.87,.31,-.19,.75,.51,-.39,-.02,.45,.45,.59) * PE_5 +
    mat4(.21,.10,.05,.27,-.30,-.29,-.41,-.28,-.12,.41,.46,.10,.11,.09,.04,-.25) * PE_6 +
    mat4(.32,-.48,-.23,-.03,.50,-.09,.69,.27,-.41,.50,-.06,-.14,-.39,.30,-.31,.06) * PE_7 +
    mat4(-.25,.25,.84,1.02,.10,.30,-.54,.95,.36,-.06,.22,-.10,-.07,-.07,-.36,.32) * PE_8 +
    mat4(.34,-.03,.38,-.20,-.21,.16,-.12,-.13,.30,.01,.59,.28,.00,.00,.00,.00) * PE_9 + vec4(-.30,-.08,-.25,-.37));
    vec4 f0_3 = relu(
    mat4(-.05,-.17,-.07,-.75,-.55,.89,.26,-.37,-.10,.15,.08,-.02,.08,-.13,.05,-.66) * PE_0 +
    mat4(-.26,.42,.20,-.31,-.11,.18,.21,-.06,.08,-.24,-.10,-.19,-.26,-.32,-.04,-.14) * PE_1 +
    mat4(-.11,-.07,-.30,-.28,-.14,.23,-.03,-.08,-.25,.16,.38,-.12,-.08,.28,.21,.22) * PE_2 +
    mat4(-.21,-.23,-.16,-.36,-.66,.41,.24,-.35,.10,-.54,-.50,-.04,-.11,.02,-.05,.37) * PE_3 +
    mat4(-.76,.94,.36,-.26,1.48,-.24,-.09,1.19,-.48,-.79,.43,-.12,-.10,.80,-.76,-.40) * PE_4 +
    mat4(1.48,-.11,-.76,.97,-.02,-.19,.26,-.30,.49,.33,.39,.77,.32,.03,.52,-.51) * PE_5 +
    mat4(-.28,-.73,.01,-.01,-.41,.36,.56,.28,.28,.87,.34,-1.20,.07,.09,-.06,.28) * PE_6 +
    mat4(-.16,.01,.88,.25,.23,-.24,-.15,.12,.06,.43,.03,.30,.12,.16,-.23,-.05) * PE_7 +
    mat4(.24,-.16,-.60,.01,-.13,-.13,.06,.24,-.02,.22,.25,-.13,.08,.09,-.02,-.05) * PE_8 +
    mat4(-.19,-.22,-.01,.10,.25,.09,.13,-.10,-.09,-.21,.06,.48,.00,.00,.00,.00) * PE_9 + vec4(-.13,-.07,-.41,-.17));
    vec4 f0_4 = relu(
    mat4(.55,-.08,.01,.19,-.23,-.17,-.23,.12,-1.16,.06,-.30,.36,.07,-.11,.16,-.07) * PE_0 +
    mat4(.11,-.17,-.17,.10,-.97,.08,-.24,.50,-.36,-.23,.04,-.25,-.31,-.00,.06,-.11) * PE_1 +
    mat4(-.06,-.15,.08,-.06,-.39,.03,.23,.01,.56,-.39,-.32,-.15,-.74,.14,-.59,.44) * PE_2 +
    mat4(-.42,-.04,.35,-.38,.11,.13,-.22,-1.08,-.02,-.05,.12,-.57,-.09,.46,.06,-.30) * PE_3 +
    mat4(-.14,.10,-.44,.97,-.59,.08,-.43,.80,.93,-.40,.04,-.57,-.33,-.32,-.09,-.30) * PE_4 +
    mat4(.01,-.55,-.06,-.11,.17,-.32,-.16,.09,-.42,.09,.47,-1.03,-.83,.05,-.44,.92) * PE_5 +
    mat4(-1.46,-.78,-.71,1.18,.16,-.01,.73,.25,.61,.34,.05,-.07,.25,.18,.08,-.10) * PE_6 +
    mat4(.23,.00,.36,.15,-.82,.79,.00,.35,-.32,-.12,.41,.28,-.07,.03,.32,.10) * PE_7 +
    mat4(-.80,-.73,.95,.39,.00,.17,.04,-.08,.02,-.04,.17,-.09,-.16,-.36,.22,-.29) * PE_8 +
    mat4(.13,.83,.19,.34,.07,.19,.18,-.15,.41,-.14,-.38,.08,.00,.00,.00,.00) * PE_9 + vec4(-.15,-.30,-.23,-.21));
    vec4 f0_5 = relu(
    mat4(-.30,1.00,-.34,.69,.31,.11,.33,-.95,-.19,.23,-.11,-.28,-.09,.56,-.17,.34) * PE_0 +
    mat4(.27,.04,.49,-.41,-.03,.27,.05,.04,.24,-.17,-.24,-.15,.06,-.01,-.32,-.60) * PE_1 +
    mat4(.24,-.47,-.06,.03,-.13,.10,.18,-.17,.12,-.22,.21,.83,-.33,.40,.01,.35) * PE_2 +
    mat4(.37,-.34,-.03,-.10,.22,-.17,-.15,-.56,.41,-1.11,-.14,-.67,-.23,-.62,.55,-.48) * PE_3 +
    mat4(.07,-.35,-.08,.77,-.63,-.62,.51,-.73,.01,-.00,.16,.34,-.27,.20,.24,1.41) * PE_4 +
    mat4(.34,1.39,.11,-.94,-.07,.07,.83,.15,-.29,.52,-.29,.39,-.09,.49,-.43,-.13) * PE_5 +
    mat4(.53,.45,-1.21,-.13,-.58,1.08,-.28,-.21,-.51,-.93,.06,.36,-.15,.03,-.39,-.04) * PE_6 +
    mat4(.84,.23,-.30,-.58,.54,-.82,.05,.10,-.59,.09,-.21,-.02,.13,.05,.40,.32) * PE_7 +
    mat4(-.01,.34,-.23,-.09,.09,-.00,.36,-.04,-.25,-.51,.05,-.31,-.05,.34,-.34,.28) * PE_8 +
    mat4(.16,.00,.13,-.01,.08,.31,.25,.19,-.23,-.26,.00,.26,.00,.00,.00,.00) * PE_9 + vec4(-.04,.02,-.18,-.03));
    vec4 f0_6 = relu(
    mat4(-.83,.07,-1.02,.64,.53,.57,.35,.05,-.12,.61,.60,-.02,-.83,.02,-.80,.60) * PE_0 +
    mat4(.20,.36,.49,.21,-.10,.49,.62,-.02,-.08,-.11,-.28,-.38,-.32,-.30,-.02,-.10) * PE_1 +
    mat4(-.31,-.18,-.10,-.47,-.50,.06,-.25,.47,.03,-.09,.24,.25,.01,.29,.42,-.18) * PE_2 +
    mat4(-.32,-.05,-.68,-.35,-.37,-1.08,.43,.50,-1.10,-1.50,-.67,-.70,-.26,.16,.51,.65) * PE_3 +
    mat4(-.51,.67,.36,.49,1.32,.41,.17,-.17,-.84,-.30,-.70,-.93,-.25,-.12,-.50,-.67) * PE_4 +
    mat4(-.72,-.28,.54,-.41,.61,-.02,.17,-.01,.03,-.39,-.40,.67,.43,-.08,.54,.84) * PE_5 +
    mat4(-.77,-.97,-.19,-.36,-.76,-.05,-.06,.97,.29,-.01,-.63,.30,-.74,.05,-.02,.78) * PE_6 +
    mat4(.07,-.00,.10,.11,-.47,.40,.21,-.18,-.65,-.54,.79,.00,.14,-.08,.58,.25) * PE_7 +
    mat4(-.07,.53,-.26,.04,-.23,.13,-.13,.90,.12,-.19,-.12,.23,.09,-.14,.05,.31) * PE_8 +
    mat4(.18,-.48,.08,.28,-.09,.11,-.13,.05,.12,.24,-.22,-.07,.00,.00,.00,.00) * PE_9 + vec4(.05,-.18,-.12,-.19));
    vec4 f0_7 = relu(
    mat4(.09,.75,-.23,.31,-.39,.16,-.55,-.35,-.11,.44,-.25,-.24,-.01,.59,-.17,.22) * PE_0 +
    mat4(-.24,-.10,-.41,-.10,-.14,.42,-.36,-.30,-.04,-.04,-.11,-.01,-.10,.04,-.63,-.15) * PE_1 +
    mat4(-.02,-.01,-.32,-.18,-.06,.16,-.12,-.26,.24,.14,-.38,-.27,.11,.39,-.64,-.25) * PE_2 +
    mat4(-.30,-.57,.06,.19,-.02,.37,-1.39,-.63,.10,-.21,-.24,.05,-.35,-.15,-.05,-.49) * PE_3 +
    mat4(-.81,.10,-.57,-.88,1.35,.38,.08,-.19,-.69,-1.43,.96,-.31,-.24,-.06,-.61,-.03) * PE_4 +
    mat4(-.49,-.76,1.42,-.20,.22,-.32,-.06,1.22,-.16,-.39,.35,.09,-.09,-.01,.17,.04) * PE_5 +
    mat4(.47,1.01,.43,-.48,-.05,-.12,-.26,-.25,-.45,-.68,.53,-.62,.24,-.00,-.26,.15) * PE_6 +
    mat4(-.33,.10,-.45,.10,.38,.24,-.25,.62,-.22,1.21,.40,.14,-.55,.16,.02,-.28) * PE_7 +
    mat4(-.21,.32,-.52,.13,.08,.25,.26,-.69,-.06,.03,-.13,.14,-.04,-.14,.08,-.16) * PE_8 +
    mat4(-.02,-.30,.58,-.17,-.34,.10,.02,-.35,-.03,.09,-.03,.11,.00,.00,.00,.00) * PE_9 + vec4(.01,-.07,-.34,-.26));
    vec4 f0_8 = relu(
    mat4(-.96,.11,-.77,.92,-.97,-.19,-.37,-.15,-1.17,.02,.22,-.29,-.59,.13,-.52,.73) * PE_0 +
    mat4(-.15,.15,-.09,-.25,-.74,-.08,.16,-.31,-.07,-.06,-.20,-.18,-.08,.19,-.12,.06) * PE_1 +
    mat4(-.35,.03,-.17,.14,.31,.04,-.19,.21,.83,.13,-.06,-.29,-.39,-.03,.18,-.21) * PE_2 +
    mat4(-.11,.07,-1.11,-.54,.60,-.03,.70,-.12,-.75,.23,-.33,.12,.26,-.06,.71,-.27) * PE_3 +
    mat4(.37,-1.04,-.15,-.36,-.45,.09,.04,.66,.35,-.33,-1.61,-.91,.66,-.01,-.45,-.41) * PE_4 +
    mat4(-1.29,-.19,.62,.41,.05,.50,.02,-.38,.34,-.17,.47,-.53,.27,.88,.16,.92) * PE_5 +
    mat4(-.58,.38,.72,-.27,.33,-.42,.21,-.60,.33,-.53,-.73,.74,-.06,-.20,.47,.10) * PE_6 +
    mat4(.20,.27,-.02,-.21,-.54,.31,-.48,-.27,-.18,-.73,-.79,-.03,.22,.14,.37,.07) * PE_7 +
    mat4(-.81,.48,-.28,.05,-.04,.31,.08,.09,-.05,-.36,-.14,-.02,-.17,-.50,-.46,-.03) * PE_8 +
    mat4(.19,.16,.13,.76,-.20,.22,.04,-.05,-.13,-.16,-.72,.20,.00,.00,.00,.00) * PE_9 + vec4(.14,-.06,-.19,.02));
    vec4 f0_9 = relu(
    mat4(-.17,.05,-.06,1.02,-.35,-.34,.69,-.50,-.39,-.22,-.07,-1.20,-.21,.21,-.09,.67) * PE_0 +
    mat4(-.12,-.39,.59,-.20,-.36,-.21,-.13,-.82,-.02,-.23,-.15,-.21,-.11,-.01,-.14,.04) * PE_1 +
    mat4(-.22,-.24,-.00,-.29,-.09,-.07,-.00,-.08,-.35,-.50,.79,.33,-.52,-.26,-.27,-.42) * PE_2 +
    mat4(.15,.10,.35,-.40,-.79,-.21,.50,.52,.11,-.05,.30,-.02,-.23,-.10,-.18,-1.10) * PE_3 +
    mat4(-.69,-.79,.19,-.02,-.38,-.56,.13,.47,-.23,-.16,.76,.05,-.15,.00,.62,.39) * PE_4 +
    mat4(-.26,-.59,1.05,.16,.22,.48,-.08,.46,-.25,.31,-.59,-.65,-.08,-.44,.77,.55) * PE_5 +
    mat4(-.53,-.20,-.00,-.61,-.48,.56,.63,-.19,-.59,.13,.00,.54,.17,.48,.48,-.40) * PE_6 +
    mat4(-.04,-.52,.35,.23,.53,-.43,-.40,-.00,.24,-.02,.14,-.77,-.61,-.77,.36,-.23) * PE_7 +
    mat4(.29,.29,-.29,-.15,.32,.28,.02,-.07,-.27,.25,.09,.14,.51,-.35,.20,.26) * PE_8 +
    mat4(.26,.27,.01,.54,-.49,.47,.11,.12,.06,.37,-.00,-.36,.00,.00,.00,.00) * PE_9 + vec4(-.29,-.44,-.28,.05));
    vec4 f0_10 = relu(
    mat4(-.01,-1.07,-.39,.78,.06,.32,.10,-.37,-.04,.34,-.77,-.36,-.10,-.69,-.14,.80) * PE_0 +
    mat4(.43,-.18,-.12,-.15,-.22,.39,-.71,-.39,-.21,-.27,-.17,-.25,.01,-.37,-.28,-.23) * PE_1 +
    mat4(-.21,-.42,-.42,-.20,-.56,.63,-.24,.85,.42,-.21,-.34,.09,-.12,.33,-.34,-.41) * PE_2 +
    mat4(-.12,-.18,-.09,-.49,-.15,-.02,-.61,.50,-.08,-.95,-1.09,-.06,-.66,.31,.29,.50) * PE_3 +
    mat4(-.15,.84,-.73,.97,.54,-.03,.17,.23,-.48,.48,-.22,-.31,.68,.82,1.40,-.10) * PE_4 +
    mat4(.06,.09,-1.46,.19,.84,-.11,-.01,-.42,1.19,.47,-.46,-.06,-.06,-.55,-.59,.21) * PE_5 +
    mat4(1.10,.80,1.08,.72,-.20,.10,-.22,.63,-.10,-.80,.27,-.35,-.40,-.13,.08,.93) * PE_6 +
    mat4(-.16,-.58,-.18,-.32,.19,.15,.08,-.81,-.46,-.40,.82,-.27,.97,-.23,-.15,.10) * PE_7 +
    mat4(.65,-.17,-.06,-.07,-.28,-.02,.07,-.62,-.15,-.02,.06,.03,.06,-.05,.13,-.11) * PE_8 +
    mat4(-.25,.29,.09,.00,-.01,-.10,-.23,.02,-.27,-.00,.04,.21,.00,.00,.00,.00) * PE_9 + vec4(-.25,-.05,-.09,-.17));
    vec4 f0_11 = relu(
    mat4(.67,-.12,.08,-.46,-.84,.03,-.30,-.35,-.60,-.20,-.21,-.09,.61,-.27,.01,-.19) * PE_0 +
    mat4(-.71,.09,-.03,-.34,-.69,-.09,.01,.24,-.17,-.01,-.18,-.32,-.28,-.04,.09,-.56) * PE_1 +
    mat4(-.04,-.01,-.11,-.13,.39,-.10,-.22,-.02,-.70,-.13,-.08,-.16,-.61,-.28,-.08,.40) * PE_2 +
    mat4(-.06,.19,.14,-.58,-.30,.05,.05,-1.38,-.07,.27,.17,-.23,-.14,.03,-.05,.22) * PE_3 +
    mat4(-.78,.19,.18,.44,-.07,.09,.24,1.29,.58,.07,.56,-.19,-.29,-.02,-.27,-.21) * PE_4 +
    mat4(.38,.02,.11,-.12,-.05,.21,.13,-.07,-.16,-.40,.28,1.34,-.39,-.16,.17,-.45) * PE_5 +
    mat4(-.61,.59,.95,-.12,-.06,.54,.31,-.41,-.03,-.93,-.02,-.58,.68,.02,.06,-.20) * PE_6 +
    mat4(-.01,-.16,.31,-.46,.34,-.05,.10,.91,-.09,.07,.40,.05,.14,.12,.67,.15) * PE_7 +
    mat4(.05,.23,.12,.09,.05,-.12,.47,.07,-.04,-.10,.60,.09,-.12,.85,.33,.10) * PE_8 +
    mat4(-.13,.31,.20,.23,.23,-.05,-.36,.34,-.04,-.42,-.11,.18,.00,.00,.00,.00) * PE_9 + vec4(-.28,-.31,-.17,-.02));
    vec4 f0_12 = relu(
    mat4(-.20,-.25,-1.18,.03,-.07,-.12,.13,.08,-.21,-.52,-.85,-.04,-.07,-.18,-.90,.00) * PE_0 +
    mat4(-.09,.00,-.09,-.07,-.08,-.20,-.63,.08,-.10,.04,-.46,-.08,.12,-.51,.15,-.11) * PE_1 +
    mat4(-.25,.23,-.28,-.52,.02,-.11,-.23,-.16,-.01,.28,.01,-.20,-.18,-.39,-.36,.01) * PE_2 +
    mat4(-.27,.13,-.57,-.04,.28,-2.27,.95,-.36,-.00,-.09,-.32,-2.02,.09,.06,.05,.06) * PE_3 +
    mat4(.67,-.28,-.28,.92,.04,.22,.65,.11,-.30,.19,-.82,.08,.03,.63,-.20,.08) * PE_4 +
    mat4(-.36,-.66,.38,-.63,-.04,.13,-.46,-.02,.58,.29,-.14,-.63,-.12,.03,.78,.57) * PE_5 +
    mat4(.87,.11,-.34,.82,-.65,-.76,.58,1.32,-1.39,.50,.66,.16,.01,.09,-.47,-.00) * PE_6 +
    mat4(-.33,.12,.15,.21,.03,-.67,-.04,1.02,-.20,.00,-.43,-.80,.37,-.19,.22,-.22) * PE_7 +
    mat4(-1.23,.00,-.21,-.36,.14,-.08,.82,.03,-.41,.02,-.10,-.13,-.26,-.25,.14,-.06) * PE_8 +
    mat4(.39,.05,-.39,.17,-.09,.56,-.06,.08,-.17,.40,.15,.40,.00,.00,.00,.00) * PE_9 + vec4(-.29,.09,-.06,-.31));
    vec4 f0_13 = relu(
    mat4(-.01,.67,.54,.01,-.31,.44,-.13,.24,-.64,-.96,.30,-.01,-.07,.13,.48,-.17) * PE_0 +
    mat4(.01,-.01,-.19,.37,-.56,-.63,.16,-.16,-.17,-.16,-.23,-.25,-.18,-.49,-.14,-.09) * PE_1 +
    mat4(-.08,-.25,-.34,-.22,.09,-.20,.32,-.02,.16,.06,-.18,.04,-.69,-.28,.10,-.02) * PE_2 +
    mat4(-.22,-.15,-.15,.02,-.98,-.91,-.49,.04,-.08,-.24,-.67,.11,-.05,-.32,.50,.17) * PE_3 +
    mat4(.55,.43,.88,.41,-.15,.22,-.02,.04,-.72,.39,.04,-.05,.01,-.22,-.68,-.21) * PE_4 +
    mat4(-.50,-.42,-.25,-.50,.14,.18,-.29,-.26,.89,-.29,-.11,-.11,1.68,.49,.60,-.27) * PE_5 +
    mat4(.53,.26,.48,-1.09,-.16,-.57,.54,-.02,-1.42,-.45,1.15,-.13,-.01,-.47,-.12,-.02) * PE_6 +
    mat4(-.03,-.22,.56,-.00,-.72,-1.19,-.10,.02,-.23,-.11,-.33,-.50,.49,.42,-.10,.08) * PE_7 +
    mat4(.63,-.19,-.11,-.37,.15,.11,.26,-.16,.06,.13,-.09,-.05,.71,-.21,-.01,.59) * PE_8 +
    mat4(-.17,.41,-.14,-.45,.33,.64,.06,.07,1.45,.19,-.07,-.11,.00,.00,.00,.00) * PE_9 + vec4(-.09,.20,-.15,-.17));
    vec4 f0_14 = relu(
    mat4(.00,.38,-.55,.11,.12,-.37,.33,.04,.05,-.73,.04,-.07,-.09,.14,-.36,.25) * PE_0 +
    mat4(-.20,.31,-.08,.02,.06,-.63,.18,-.14,.03,-.04,-.02,-.02,-.04,-.15,-.30,.10) * PE_1 +
    mat4(-.12,.10,-.16,-.16,.08,.05,-.21,-.02,-.29,.41,-.22,.27,.10,-.67,-.17,-.02) * PE_2 +
    mat4(.07,-1.26,.28,.12,.27,.31,.07,-.17,-.13,-.00,-.31,.13,.04,-.35,.39,-.09) * PE_3 +
    mat4(.22,-.06,.77,.05,-.04,-.03,-1.30,.06,.43,-1.58,.54,.40,-.02,-.19,-.03,-.54) * PE_4 +
    mat4(-.12,-.88,-.31,.20,-.48,.58,-.05,-.02,-.33,-.10,-.13,.19,-.21,.69,-.28,.24) * PE_5 +
    mat4(-.04,2.67,-.42,.88,.01,.09,.37,.18,.74,-.12,.25,.37,.30,-.32,.00,-.29) * PE_6 +
    mat4(-.11,.01,-.42,-.25,-.22,-1.04,-.02,-.13,.49,.37,.36,.18,-.16,.11,.08,-.75) * PE_7 +
    mat4(.19,.64,.49,-.17,-.07,.05,.09,-.00,-.27,-.12,.16,.30,.31,.03,.58,-.05) * PE_8 +
    mat4(-.22,-.67,.38,.47,-.12,.09,-.22,-.45,-.27,.14,.31,-.30,.00,.00,.00,.00) * PE_9 + vec4(-.13,-.04,-.04,-.27));
    vec4 f0_15 = relu(
    mat4(.21,-.06,-.57,-.02,1.62,.08,.67,.05,.19,.03,.01,.10,-.01,.02,-.50,-.16) * PE_0 +
    mat4(.74,.26,.29,-.00,.23,.03,.23,.13,.12,-.14,-.40,.07,-1.04,-.33,-.28,-.03) * PE_1 +
    mat4(-.19,-.17,-.33,-.12,-.07,-.13,-.24,.16,-.63,.04,.50,-.27,-.02,.20,.24,.04) * PE_2 +
    mat4(.15,.01,-.41,.19,-.79,.18,.31,.05,-.54,-.12,-.14,-.18,-.12,.16,.31,.10) * PE_3 +
    mat4(-.01,.13,.95,-.24,-.90,.46,.28,-.64,.19,.58,-.37,.48,.69,-.42,.95,-.14) * PE_4 +
    mat4(-.36,-.29,.11,-.03,-.03,.35,.01,-.13,-.53,.43,-.22,-.43,1.12,.33,-.17,.19) * PE_5 +
    mat4(-.12,-.14,-1.01,.38,.16,-.17,.35,.36,.76,.59,.66,.24,-.03,.03,.03,-.06) * PE_6 +
    mat4(.94,-.56,-.24,.14,.08,-.60,.24,-.17,.00,-.18,.73,.28,.63,.42,-.24,.03) * PE_7 +
    mat4(.23,.08,-.38,.58,.04,-.13,.07,-.12,.10,.24,.01,-.13,.00,.10,-.28,.27) * PE_8 +
    mat4(.01,.09,.53,.07,.02,.17,-.12,.38,.09,.12,-.00,-.16,.00,.00,.00,.00) * PE_9 + vec4(-.14,-.26,-.15,-.20));
    
    vec4 f1_0 = relu(
    mat4(-.01,-.21,.09,-.09,-.14,-.03,.72,-.54,-.03,-.07,.00,-1.78,-.17,-.14,.14,-.86) * f0_0 +
    mat4(-.03,.03,.31,-.60,-.18,-.02,.29,.02,-.36,-.03,.04,-1.00,-.01,-.08,-.02,-.43) * f0_1 +
    mat4(.00,-.15,.42,-.19,-.24,-.18,.02,.45,-.18,-.04,-.76,-.12,-.17,-.07,-.19,.24) * f0_2 +
    mat4(-.06,-.03,-.21,-.97,-.19,-.20,.03,.33,-.02,-.18,-.77,.57,-.07,-.07,.29,-1.39) * f0_3 +
    mat4(-.12,.00,.44,.40,-.23,-.21,-.07,-.32,-.28,-.23,-.58,.34,.04,.07,.36,-1.52) * f0_4 +
    mat4(-.27,-.21,.06,.20,-.13,-.05,-.23,-.53,.03,-.23,-.00,.14,-.03,.15,.79,.52) * f0_5 +
    mat4(-.15,.13,-.48,-.73,.05,-.23,-1.31,.45,-.12,-.10,-1.20,-.79,-.02,-.08,.01,-.87) * f0_6 +
    mat4(.00,.08,-.11,-1.50,-.11,-.10,-.25,-1.82,-.16,-.17,-.76,.35,-.10,-.15,-.75,.21) * f0_7 +
    mat4(-.02,-.18,-.06,.51,-.07,-.10,.04,-.36,-.18,-.29,-.85,.01,-.16,-.06,.31,.45) * f0_8 +
    mat4(-.04,-.04,-1.33,.05,.01,-.07,-.87,.09,-.07,-.22,-.16,.40,.05,-.13,.06,-1.30) * f0_9 +
    mat4(.01,-.02,.45,.01,-.10,-.11,.74,-1.17,.08,-.07,1.92,-.84,-.13,-.01,-.18,-1.96) * f0_10 +
    mat4(-.16,-.16,-1.55,-1.28,-.01,-.12,.20,.09,-.22,.04,.12,-.23,.05,-.15,.18,.06) * f0_11 +
    mat4(-.18,.07,-.17,-.25,-.11,-.08,.63,-1.35,.04,-.06,-1.22,.59,-.17,-.04,.06,-1.71) * f0_12 +
    mat4(-.11,-.06,.37,.09,-.00,-.14,-.56,-.17,-.13,-.09,-2.49,.72,-.23,-.01,.03,.22) * f0_13 +
    mat4(-.04,-.16,-.39,.10,-.04,-.04,-.72,-.60,-.12,-.13,-.20,.17,-.03,-.04,-.35,.23) * f0_14 +
    mat4(-.02,-.15,-.07,-1.29,-.24,-.14,.24,-.68,.01,-.15,-1.30,-.66,-.04,-.16,.50,.28) * f0_15 + vec4(-.16,-.13,-.04,.10));
    vec4 f1_1 = relu(
    mat4(-.83,-.14,.04,-.57,-.33,-.35,.05,-1.69,-.99,.07,-.01,-.10,-.04,-.08,-.23,.54) * f0_0 +
    mat4(.13,.09,-.10,.41,.60,-.01,-.09,-.55,-.31,.02,-.11,.65,-1.31,.12,-.10,.75) * f0_1 +
    mat4(-.09,.21,.02,.23,-.07,-.04,.03,.63,-.37,-.02,-.31,.25,-.62,-.11,-.04,-.48) * f0_2 +
    mat4(.52,-.50,-.12,-1.66,-.08,-.02,-.18,-1.51,.49,-.00,-.11,.58,-.34,.01,.14,-.93) * f0_3 +
    mat4(-1.55,-.32,-.03,-2.15,-.00,.04,-.01,.17,.24,-.13,-.04,.79,.94,-.33,-.12,-2.09) * f0_4 +
    mat4(-.35,.12,-.10,.36,-.47,-.17,-.14,-2.23,.15,.19,-.18,-.14,1.69,-.65,-.10,-2.43) * f0_5 +
    mat4(-.44,.01,-.03,-1.74,.03,-.26,-.00,-1.94,.24,.06,.08,-1.44,.54,.11,-.12,-.95) * f0_6 +
    mat4(-.32,-.16,.05,-.75,-.42,-.39,-.14,-1.11,-1.37,-.18,-.22,-1.22,-.33,-.06,-.11,.18) * f0_7 +
    mat4(-.30,-.61,-.05,-1.30,.08,.16,-.09,.42,.40,.04,-.02,.60,.12,-.24,-.06,-1.21) * f0_8 +
    mat4(-.94,.11,-.06,.56,-.87,.12,.03,.65,-.18,.06,-.09,.66,.59,-.05,-.07,-.72) * f0_9 +
    mat4(-.11,-.03,-.04,.49,.78,-.25,-.01,-1.08,-1.27,.06,.05,-2.56,.40,.18,-.15,-.09) * f0_10 +
    mat4(-2.17,-.22,-.04,-.46,.31,-.02,-.11,.30,.18,-.04,-.05,.36,.99,-.36,-.05,-2.01) * f0_11 +
    mat4(.65,.02,-.12,.13,-.99,-.42,-.00,-2.23,-.08,-.04,-.11,-.35,.63,-.65,.02,-2.02) * f0_12 +
    mat4(.59,.34,-.04,.48,-.21,.34,-.10,-1.07,.08,-.00,-.09,-.40,.20,.05,-.16,.73) * f0_13 +
    mat4(.01,-.13,-.07,-.03,-1.30,-.25,.08,-4.00,-.59,-.10,-.15,.34,-.12,.02,-.15,.45) * f0_14 +
    mat4(1.13,-.65,.07,-2.29,.29,.02,-.18,.16,-.63,-.09,-.14,.13,-.19,.04,.05,.36) * f0_15 + vec4(-.16,-.09,-.19,.05));
    vec4 f1_2 = relu(
    mat4(-.07,-.36,.27,.45,-.54,-.94,-.66,.32,.03,-.48,.02,.68,.13,-.36,.49,.08) * f0_0 +
    mat4(.16,.45,.02,-.12,.10,-.13,-.40,-.35,-.01,.11,.09,.71,-.04,-.03,.45,-.70) * f0_1 +
    mat4(.01,-1.58,.04,-.35,.11,-.49,.16,-.31,-.00,-.58,.15,.33,.03,-.03,.05,.20) * f0_2 +
    mat4(-.41,-.38,-.95,-1.44,.02,-.92,-.62,-.50,.24,.08,.43,.33,.02,.26,-.38,-1.93) * f0_3 +
    mat4(-.20,.91,-.98,-1.95,-.10,-.92,.27,.33,.08,.34,.22,.17,-.08,-1.19,-.98,.80) * f0_4 +
    mat4(.06,-2.00,.25,-.70,-.40,.20,-.07,.46,.24,.71,-.22,.04,-.02,.14,-1.49,-.13) * f0_5 +
    mat4(-.02,-.67,-.94,-1.48,-.12,-1.56,-.78,.39,-.20,-.42,-1.41,.68,-.20,.18,-.29,-.38) * f0_6 +
    mat4(-.12,1.14,-.05,-.37,-.38,-1.55,-.48,.72,-.01,-2.28,-.66,-.36,-.05,-1.28,.13,-.78) * f0_7 +
    mat4(-.44,.18,-.47,1.65,-.08,-.59,.18,-.17,-.27,-1.47,1.00,.55,-.28,.23,-.37,.15) * f0_8 +
    mat4(.03,-.75,.02,-.28,.09,.91,.38,.23,-.02,.03,.30,-.13,-.06,.63,.03,-.29) * f0_9 +
    mat4(-.16,-1.31,.15,.10,-.21,-.28,-.34,-.04,-.14,-.83,-1.10,-1.24,-.12,-1.12,.17,-.96) * f0_10 +
    mat4(.07,-.20,-.31,.55,-.01,-.95,.09,-.21,.13,.76,.24,-.50,-.16,.42,-.29,-.88) * f0_11 +
    mat4(-.12,-1.63,.34,-1.09,-.10,-1.93,-.94,-.82,-.25,-.82,.29,-1.13,-.24,.36,-.16,.59) * f0_12 +
    mat4(.33,.14,-.24,.14,-.23,-1.54,-.55,.59,.01,-.52,.33,.64,.15,.03,-.20,-.04) * f0_13 +
    mat4(.08,.31,.31,.22,-.47,-1.04,-2.56,.04,.19,-.25,.17,.36,-.06,-.57,.21,.03) * f0_14 +
    mat4(-.00,.91,-1.14,.30,.13,-.11,.38,-.16,-.12,.37,-.57,-.56,-.05,.45,-.04,.07) * f0_15 + vec4(-.12,.21,.09,-.04));
    vec4 f1_3 = relu(
    mat4(.41,.04,-.44,.23,-.06,-.04,.08,.90,.14,-.13,-.41,.43,-.20,-.12,.03,-1.08) * f0_0 +
    mat4(-.15,-.02,-.45,-.38,-.18,.08,.01,-.37,-.00,-.09,-.46,.01,-.20,.03,.28,-1.73) * f0_1 +
    mat4(.43,.06,.03,-.63,-.29,-.09,.25,.12,-.11,.01,-.14,.33,-.19,-.16,.39,.51) * f0_2 +
    mat4(.45,-.15,-.44,-.29,-.48,-.04,.48,.08,-.34,-.02,.11,-.14,-.16,-.04,-.27,.04) * f0_3 +
    mat4(.46,-.05,-.54,-.43,-.06,.00,.27,.24,-.54,.03,-.00,-.51,-.55,-.11,-.52,.36) * f0_4 +
    mat4(.15,-.11,.06,.20,.44,-.14,-.82,.12,-.15,-.11,.18,.53,-.41,.02,-.07,-.23) * f0_5 +
    mat4(.02,-.08,.88,-.64,-.20,-.09,.22,-1.14,.70,-.11,-.13,.60,.20,-.18,-.85,-.19) * f0_6 +
    mat4(.50,-.09,.12,.17,.34,-.01,-.74,-.41,-.54,-.05,-.22,.25,-.27,-.04,-.00,-1.36) * f0_7 +
    mat4(.04,-.09,.16,-1.10,.28,-.11,-.05,-.26,-.08,-.12,.27,.97,.50,-.12,-.47,-.18) * f0_8 +
    mat4(-.37,-.14,-.44,.17,-.19,-.16,-.17,.15,-.24,-.02,.11,.40,-.20,.04,-.52,-.98) * f0_9 +
    mat4(.38,-.03,-.92,-.51,-.92,-.14,-.24,.73,-.37,-.12,-.26,-2.66,-.09,-.13,-1.24,-.22) * f0_10 +
    mat4(-.14,-.03,-.45,-.97,.09,-.05,-.01,-.19,.11,-.06,-.30,.17,.54,-.08,1.25,.43) * f0_11 +
    mat4(-.28,-.13,-.04,-.41,.01,-.04,-.06,-.44,.29,-.09,-.44,-.32,-.31,-.14,-2.05,-1.76) * f0_12 +
    mat4(-.31,-.05,-.66,.10,.48,-.14,-.57,.38,-.09,.05,-.24,.07,-.22,.02,.17,.43) * f0_13 +
    mat4(.13,-.03,.35,-.22,.13,-.14,.03,1.03,-.06,-.08,-.07,-.01,-.21,.01,-.04,.11) * f0_14 +
    mat4(.62,.07,-1.12,1.06,-.14,-.14,.45,-.12,-.37,.01,.52,.81,.51,-.04,.04,-.77) * f0_15 + vec4(-.14,-.17,.30,-.08));
    vec4 f1_4 = relu(
    mat4(.11,-.07,-.55,-.12,.31,-.00,.83,-.35,-.21,.25,-.23,.46,-.07,-.01,-.11,-.17) * f0_0 +
    mat4(-1.14,.30,-.50,-.42,-.08,-.25,-.68,-.05,-.61,.28,-.07,.24,.13,-.32,.47,-.12) * f0_1 +
    mat4(-.79,-.15,-.51,.03,-.05,-.55,-.26,-.09,-.02,-.01,-.38,.02,.10,.27,-.25,-.35) * f0_2 +
    mat4(-.18,.05,-.56,.41,.21,.38,-.11,.10,-.16,.25,-.36,.23,.57,-.09,.56,.29) * f0_3 +
    mat4(.06,.73,.08,-.92,.08,-.24,-.07,-.10,-.09,-.10,-.40,-.27,.54,1.13,.76,.73) * f0_4 +
    mat4(-.18,-.38,.16,-.29,-.22,.41,.58,-.25,.08,.35,.15,.09,1.12,-.08,.61,1.29) * f0_5 +
    mat4(.36,.59,-.58,-1.04,.23,.10,-.12,-.04,.21,.93,.17,-.14,-.26,.28,-.51,-.35) * f0_6 +
    mat4(-.23,.31,-.19,.02,-.52,.66,.25,-.40,-.07,.34,-.56,-.11,-.36,.03,-.50,.11) * f0_7 +
    mat4(.00,.65,.55,-.90,-.75,-.18,-.15,.22,.37,-.34,-.00,.42,.10,-.00,.22,.30) * f0_8 +
    mat4(-.11,.18,-.28,.12,-.34,.20,-.22,.25,.38,-.80,.01,-2.05,-.28,-.03,.27,.77) * f0_9 +
    mat4(-.39,-.25,-.61,-.26,.17,.47,.76,.63,.02,.49,.30,-1.00,-.55,-.10,-.52,.31) * f0_10 +
    mat4(.07,-.13,-.04,.03,.03,.06,-.24,-.33,-.22,.01,.24,-.13,.67,1.05,-.74,.08) * f0_11 +
    mat4(-.20,-.36,.35,.32,.41,-.27,-.94,.27,-.02,-.83,-.02,1.26,-.65,.68,-.47,-.56) * f0_12 +
    mat4(.43,.37,-.21,.25,.62,-.85,.35,.54,.27,.19,.04,.04,-.01,-.19,-.12,-.02) * f0_13 +
    mat4(-.03,-.30,.16,-.41,-.36,1.81,-1.21,1.45,.05,-.35,.56,-.34,-.32,-.19,.29,-.52) * f0_14 +
    mat4(1.44,.26,.29,-2.71,-.15,-.30,.00,-.15,.91,-.69,.43,-.28,-.19,-.24,.03,-.40) * f0_15 + vec4(.01,-.36,.16,-.08));
    vec4 f1_5 = relu(
    mat4(.12,-.19,.11,-.02,-.33,.08,-.20,-.42,-.05,-1.12,-.01,.11,-.03,-.19,.06,-.12) * f0_0 +
    mat4(.17,.09,.18,.12,-.31,.10,-.08,.02,.24,-.47,-.04,-.18,.18,.26,-.08,-.19) * f0_1 +
    mat4(.33,-.14,.02,.25,.15,-.20,.19,.00,.29,-.16,.06,.04,.37,-.10,.17,.16) * f0_2 +
    mat4(-.79,-.21,-.32,-.64,-.27,-1.27,.20,-.34,.36,-.13,.25,.34,.15,.53,-.04,.13) * f0_3 +
    mat4(-.89,-.53,-.38,-.79,-.08,.09,.02,.11,.16,-.43,-.10,.08,-.41,1.62,-.31,-.49) * f0_4 +
    mat4(.06,-.22,.03,-.05,-1.13,.86,-.02,-.31,-.11,-.01,.31,.12,-.89,.71,-.31,-.28) * f0_5 +
    mat4(-.61,.88,.04,-.26,-.96,-.39,-.25,-.15,-1.07,.51,-.32,-.84,-.03,-.64,.14,.10) * f0_6 +
    mat4(-1.08,.01,-.20,.12,-.88,.38,-.20,-.16,-.36,-.06,.05,-.43,.02,-.11,.00,.01) * f0_7 +
    mat4(-1.26,.90,-.32,-.37,.01,.05,-.15,-.05,.31,.34,.00,-.78,-.25,.06,-.22,-.05) * f0_8 +
    mat4(.22,-.20,.13,-.00,.17,-.53,.20,.10,.13,-.46,-.07,-.07,-.12,-.52,-.04,.04) * f0_9 +
    mat4(.16,-.49,.02,-.16,-.52,.14,-.29,-.07,-.90,1.21,-.15,-.36,.17,-.33,-.03,-.01) * f0_10 +
    mat4(.10,.26,.17,-.06,.15,-.13,.15,-.04,.09,-.26,.14,.08,-.67,.35,.02,-.34) * f0_11 +
    mat4(.14,-.23,.17,-.03,-.87,1.11,-.61,-.36,-.75,.23,.09,-.20,-.88,-.77,-.23,-.40) * f0_12 +
    mat4(.81,.60,.55,.35,.43,-.00,-.05,-.28,-.38,-.30,.06,.12,.21,-.17,.04,.02) * f0_13 +
    mat4(-.05,-.12,.02,.15,-.92,-1.52,.01,-.54,.41,.25,.18,.20,-.05,.12,.02,.09) * f0_14 +
    mat4(-1.68,1.44,-.57,-.05,.10,.10,.10,.17,.26,.64,-.08,-.68,.14,.44,.14,.02) * f0_15 + vec4(-.15,-.10,-.10,.08));
    vec4 f1_6 = relu(
    mat4(.39,-.85,.01,-.25,-.73,-.08,-.32,-.68,.09,-1.75,-.07,-.11,-.15,.35,-.24,-.09) * f0_0 +
    mat4(.25,-.25,.33,.29,.36,-.07,.21,.37,.34,-.03,-.18,-.11,.17,.19,.14,-.17) * f0_1 +
    mat4(-.23,.36,-.04,.06,-.02,-.23,.15,.01,.08,-.27,-.04,.01,.21,-.03,.38,.06) * f0_2 +
    mat4(-.65,-1.18,-.55,-.19,-.15,.35,-.11,-.15,.24,-2.10,.03,.46,-.15,.13,-.86,-.63) * f0_3 +
    mat4(-.75,.58,-.55,-.58,.18,-1.23,-.20,.06,.44,-.05,.11,.09,-.77,.52,-.19,-.74) * f0_4 +
    mat4(.19,-.94,.11,.01,-.96,-.37,-.26,-.66,-.00,.37,.35,-.04,-1.20,-.94,-.92,-.58) * f0_5 +
    mat4(-.84,1.14,.16,-.70,-.74,-.75,.30,-.88,-.53,.09,-.20,-.65,-.38,-.91,.51,.19) * f0_6 +
    mat4(-.94,-.30,-.78,-.40,-.94,.33,-.41,-.70,-.23,-.07,.16,-1.11,.56,-1.30,.10,.18) * f0_7 +
    mat4(-1.55,.38,-.40,.24,.08,.28,-.11,-.12,-2.51,1.32,-.95,-1.88,-2.05,.14,-.20,-.53) * f0_8 +
    mat4(.30,-.92,.21,-.02,.22,-.22,.20,.15,.10,.28,-.15,.24,.26,-.45,-.12,.28) * f0_9 +
    mat4(-.47,-.34,.42,.47,-.42,-.18,.34,.49,-.32,.43,-.10,.35,-.10,-.38,-.31,-.25) * f0_10 +
    mat4(.53,-.50,.13,.12,-.02,-.23,.11,.17,.20,-.32,.22,-.02,-.89,.84,.17,.23) * f0_11 +
    mat4(.22,-.95,.21,.28,-1.41,-.53,-.75,-1.59,-.96,.26,-1.10,-.81,-1.16,-.35,-.80,-.42) * f0_12 +
    mat4(.25,.17,.30,-.05,-.65,.41,-.55,-1.09,-.03,-.00,.09,.25,.20,.44,.11,-.13) * f0_13 +
    mat4(-.02,-.04,-.23,.37,-.79,-.59,-1.30,-.50,.11,.05,.01,-.12,.25,-.34,-.08,-.22) * f0_14 +
    mat4(-.07,.30,-.96,-.13,-.03,-.93,.19,.48,-.63,.74,.34,-.86,.14,.20,.13,.06) * f0_15 + vec4(-.01,.07,-.06,-.01));
    vec4 f1_7 = relu(
    mat4(-.70,.17,-.43,.09,-1.57,.21,-.62,.54,.17,-.04,-.09,.09,-.13,-.28,-.06,-.23) * f0_0 +
    mat4(.21,-.45,.06,-.02,-.02,-.83,.15,.41,-.13,.40,.43,-.61,-.01,.36,-2.08,-.22) * f0_1 +
    mat4(.38,.06,.14,.32,.03,-.86,-1.15,-.14,.13,.17,-.36,-.21,-.43,.44,.57,-.37) * f0_2 +
    mat4(.34,-1.17,.14,.34,-.32,.28,-.25,.42,.49,-.21,-.06,-.32,.29,-.16,-.86,-.02) * f0_3 +
    mat4(-1.50,-.14,-.93,1.01,.10,-.53,-.21,.17,.06,-.15,-1.79,-.27,-.41,1.73,-1.72,.94) * f0_4 +
    mat4(.44,.29,-.26,-.41,-1.98,-.68,.20,.67,-.16,.27,.50,-.23,-1.25,-.43,-.35,1.11) * f0_5 +
    mat4(-.75,.13,-.56,.43,-1.15,.48,.29,.72,-1.08,-.45,-.11,.58,-1.19,.15,-1.47,.37) * f0_6 +
    mat4(-.56,.57,-.25,.05,-.43,-1.40,-1.33,.46,-.89,-1.27,-2.02,.20,.01,-.12,.25,.15) * f0_7 +
    mat4(-.42,.20,-.30,.70,.07,-.35,.47,-.07,-.86,.59,.46,.35,-1.17,-2.41,.71,.54) * f0_8 +
    mat4(.01,-.19,-.56,-.36,.31,-.09,-.19,-.13,.09,-.38,.14,-.15,.27,-.12,.07,.28) * f0_9 +
    mat4(-.24,-.33,.25,.25,-.70,.31,-1.05,-.34,-.76,-.78,-.93,1.68,-.33,-.24,-.24,.17) * f0_10 +
    mat4(-.71,-.21,.54,.12,.43,.07,.11,-.33,-.01,-.46,-.14,.21,-.75,.98,1.13,.10) * f0_11 +
    mat4(.15,-.22,-.87,-.32,-1.19,-.22,-1.46,.00,-1.29,-.42,-1.56,.55,-.92,.75,.25,.95) * f0_12 +
    mat4(-.40,-.23,-.54,-.87,.25,-.68,-1.76,.39,-.15,.15,-.17,-.00,.08,.35,-.50,.07) * f0_13 +
    mat4(-.06,.19,.15,.06,-1.06,-.98,-2.75,.74,.16,-.08,.14,-.25,-.02,-.77,-.29,.46) * f0_14 +
    mat4(-1.05,1.59,-.52,-.32,.34,-.21,.39,-.06,-.30,-.57,.55,.26,.26,-.32,-.18,.11) * f0_15 + vec4(.11,-.12,-.03,-.29));
    vec4 f1_8 = relu(
    mat4(.54,-.01,-.54,-.33,-1.98,-.47,-1.13,.79,-.60,.14,-.14,.01,.08,.20,-.01,-.08) * f0_0 +
    mat4(-1.29,-.20,.36,-.08,-.24,-.00,-.14,.34,-.56,-1.23,-.21,.29,-.20,.10,.08,-.15) * f0_1 +
    mat4(-.80,.07,.14,.45,.09,.10,-.04,-.35,-.09,.29,.20,.10,.12,.32,-.31,.02) * f0_2 +
    mat4(-.57,-.95,-.46,.59,-1.56,-.13,-1.28,.02,-.59,.06,.24,-.06,.51,-.56,.13,-.05) * f0_3 +
    mat4(-.19,-.21,-1.19,.93,.12,-.05,.09,.25,-.49,.04,.01,-.25,-.11,-.06,.01,-.04) * f0_4 +
    mat4(-.05,.08,.02,-.31,-.54,.27,.08,.64,-.98,-.44,.18,-.04,.48,-.66,-.82,.97) * f0_5 +
    mat4(.03,-.62,-.69,.85,-1.18,-1.84,-1.54,.81,.42,-.78,-.89,.43,-.02,.72,-1.14,.54) * f0_6 +
    mat4(.32,.03,-.25,.08,-.25,.33,.14,-.71,.73,-.35,-.77,.46,-.68,.08,-.05,-.29) * f0_7 +
    mat4(-1.18,-.62,-1.01,.03,-.31,.25,.32,.08,.03,-.56,-.23,-.89,-1.83,-.10,-.65,.67) * f0_8 +
    mat4(-.53,.16,.09,-.41,.16,.26,-.16,-.22,.30,-.15,.13,-.51,-.60,-.18,-.08,.32) * f0_9 +
    mat4(-.93,-.61,.54,.39,.40,-1.05,-.98,.66,-.26,-.58,-.60,-.73,-.55,-.56,-.44,.05) * f0_10 +
    mat4(.33,-.11,-.14,.24,.18,.25,-.23,-.47,-.17,.01,.15,.16,.67,-.30,-.51,.54) * f0_11 +
    mat4(-1.55,.26,.03,-.01,-1.64,-.64,-1.16,-.12,-.08,-1.33,-.37,.16,-.09,-.32,-.39,.29) * f0_12 +
    mat4(.26,.68,-.49,-.48,.27,-1.33,.01,-.22,-.85,-.06,.12,.00,-.24,-.33,.46,.47) * f0_13 +
    mat4(.44,-.49,.15,.02,.61,-.40,-1.02,.37,.09,.01,.19,-.22,-1.09,-.04,.21,-.24) * f0_14 +
    mat4(.11,-.32,-1.17,-.36,-.50,-.19,-.10,-.02,.59,.14,.19,-.39,.08,.14,.05,-.04) * f0_15 + vec4(.08,-.12,-.08,-.23));
    vec4 f1_9 = relu(
    mat4(-.18,.28,-.15,.39,-.03,.39,-.37,-1.01,-.08,-.24,-.07,.09,-.14,.06,.07,.12) * f0_0 +
    mat4(-.28,.69,.34,-.02,-.28,-.27,-.15,.23,-.01,-.07,-.08,-.22,-.13,-.25,.20,-.52) * f0_1 +
    mat4(-.25,-.43,.04,-.24,-.23,-.28,.11,-.62,-.13,-.72,.18,.05,-.16,.16,.34,.33) * f0_2 +
    mat4(.05,.46,-.58,.73,-.07,-1.00,-.11,-.09,-.06,-.34,.46,.21,-.24,.37,-.09,.40) * f0_3 +
    mat4(.03,.42,-.29,-1.19,-.04,-1.03,-.10,-.19,-.10,-.22,.12,.29,-.21,.51,-.29,.20) * f0_4 +
    mat4(-.32,.29,.18,-.81,-.14,-.26,-.29,-.72,-.14,-.13,.40,-.55,-.16,-.06,-.44,1.21) * f0_5 +
    mat4(-.22,.62,-.06,.25,-.17,.54,-.26,.33,-.11,.04,-.22,.60,-.14,-.39,.20,.18) * f0_6 +
    mat4(-.15,-.17,-.19,-.12,-.13,.77,-.31,.66,-.20,.14,-.06,.24,-.17,.11,.09,-.07) * f0_7 +
    mat4(-.15,1.59,-.75,-.47,-.24,-.63,.07,.06,-.03,-.01,-.37,-.13,-.02,-.04,-.14,-.46) * f0_8 +
    mat4(-.27,-.50,.39,-.04,-.08,-.78,.27,-.20,-.10,-.24,-.18,-.18,-.07,-.38,-.11,.24) * f0_9 +
    mat4(-.14,-.62,-.20,.64,-.33,.52,-.06,1.06,.07,.23,-.37,-.11,-.10,-.34,.01,.33) * f0_10 +
    mat4(-.07,-.21,.18,.43,-.23,-.16,.17,-.00,-.20,.16,.05,-.04,-.20,-.44,-.22,.04) * f0_11 +
    mat4(-.16,.11,-.01,-.25,-.07,-1.00,-.26,.41,-.12,.37,-.14,-.28,-.03,-.96,-.35,.66) * f0_12 +
    mat4(-.19,.73,.69,.33,-.11,.69,-.22,.26,-.02,.29,.06,.39,-.19,.22,.20,-.07) * f0_13 +
    mat4(-.31,-.23,.07,-.30,-.10,-.62,-.16,1.07,-.29,-.47,.26,-.05,-.31,.00,-.14,-.11) * f0_14 +
    mat4(-.07,.93,-.73,-.28,-.10,-.10,.39,-.13,-.13,-1.90,.00,.23,-.10,.07,.15,-.08) * f0_15 + vec4(-.12,-.14,.15,-.17));
    vec4 f1_10 = relu(
    mat4(.09,.04,-.54,.47,-1.03,-.18,.59,-.32,.05,-.12,-.58,.23,.12,-.23,-.39,.20) * f0_0 +
    mat4(.13,-.12,-.54,.02,-.61,.14,-1.16,.41,.17,-.18,.31,-.09,.11,-.11,.25,-.32) * f0_1 +
    mat4(.09,-.28,.34,-.05,-.04,-.19,-.73,-.15,.57,.05,.27,-.17,-.01,.03,-.34,.02) * f0_2 +
    mat4(-1.02,-.28,-.52,-.94,-.47,-.21,.35,-.28,.27,.06,.51,.00,-1.11,-.31,-.06,.14) * f0_3 +
    mat4(-.95,-.25,-1.13,.61,.08,-.27,.04,-.42,.25,-.02,-.28,-.59,-1.00,-.09,-.10,-.30) * f0_4 +
    mat4(-.03,-.07,-.13,-.40,-1.35,-.14,.63,-.42,-.19,-.14,.34,-.45,-.57,.18,-1.17,-.15) * f0_5 +
    mat4(-.91,-.12,-.03,-.27,-.87,-.12,.27,.54,-1.24,-.03,.66,.96,-.43,-.12,.44,.44) * f0_6 +
    mat4(-.46,-.35,-.75,-.15,-.14,-.13,-1.23,.33,-.99,-.03,.51,-.40,.20,-.13,-.78,.31) * f0_7 +
    mat4(-.79,.03,-.11,.54,.13,-.14,.29,-.62,-.42,-.43,.78,.28,-.69,-.05,-.75,.20) * f0_8 +
    mat4(.16,-.07,-.10,.11,.34,-.22,-.30,.05,.27,.12,-.90,-.44,-.53,-.30,-.50,.07) * f0_9 +
    mat4(-.22,-.46,-.29,.33,.15,-.26,.11,-.10,-1.06,.05,-.52,.65,-.16,-.09,-.95,-.11) * f0_10 +
    mat4(-.53,-.22,-.25,.12,.31,-.19,-.11,-.53,.09,.00,.13,-.08,.01,-.12,1.33,.52) * f0_11 +
    mat4(-.24,-.14,-.92,.14,-.73,.08,-.25,.75,.39,-.22,.96,-.24,-1.46,-.15,-.11,.81) * f0_12 +
    mat4(1.19,.19,-.71,.13,-.43,.12,.24,.95,-.19,-.09,.30,.12,.34,-.06,.11,-.21) * f0_13 +
    mat4(-.08,-.11,-.14,-.11,-.58,.12,.54,1.58,.17,-.06,.61,.07,.28,-.23,.27,-.11) * f0_14 +
    mat4(-.79,.06,-1.38,.81,.09,-.08,-.09,.02,-.06,-.14,1.10,.48,.09,-.03,.34,-.24) * f0_15 + vec4(.14,-.15,-.16,-.13));
    vec4 f1_11 = relu(
    mat4(-.50,.03,.23,-.37,.51,-.11,.42,-.12,-.08,.19,-.88,.05,-.16,.48,-.27,.43) * f0_0 +
    mat4(-.21,.04,-.48,.14,-.24,-.12,-.15,-.48,-.62,.07,-.35,.74,.10,-.02,-.93,.34) * f0_1 +
    mat4(-.34,-.08,.35,.22,-.37,.18,-.03,.47,-.13,.19,-.04,.37,.08,-.21,.06,.12) * f0_2 +
    mat4(-.39,-.80,.83,-.13,.41,-.15,-.34,.01,.52,.22,.01,.19,-.63,-.32,.55,.03) * f0_3 +
    mat4(.47,-.82,-.31,-.66,-.07,.32,-.08,.48,-.10,.10,-.17,.40,-1.46,-.73,.58,-.44) * f0_4 +
    mat4(.16,-.03,.04,.34,-.03,-.18,.61,-1.27,.04,-.07,.48,-.20,-.22,-1.22,.28,-1.18) * f0_5 +
    mat4(.05,-.79,.44,-.39,.83,-.34,1.07,-.18,.58,-.00,.29,.18,-.32,-.68,-.28,-.73) * f0_6 +
    mat4(-.70,-.24,-.23,-.07,-1.02,-.68,-1.08,-.81,-.12,-.42,.08,-.98,-.90,.16,-.57,.11) * f0_7 +
    mat4(-.86,-.57,.39,-.10,-.33,.14,-.24,.51,-.29,-.45,.26,1.03,-.79,-.42,.26,-.19) * f0_8 +
    mat4(.07,-.19,-.79,.15,-.18,.26,-.27,.29,-.07,.00,-.45,.60,-.13,-.23,.11,-.18) * f0_9 +
    mat4(-.43,.40,-.02,.04,.68,-.24,.63,-1.42,.35,-1.06,-.55,-.86,.44,-.23,-.48,-.12) * f0_10 +
    mat4(-.24,-.25,.25,-.69,.16,-.11,-.94,.19,-.57,.11,.16,.20,.67,-.01,1.00,-1.70) * f0_11 +
    mat4(-.17,.04,-.10,.24,-.16,-.74,-.12,-.18,.78,-.10,.37,.37,.48,-.68,-1.71,-1.08) * f0_12 +
    mat4(-.42,-.08,.12,.39,.31,.07,.62,-.23,.35,.02,-.36,-.27,.56,.06,.08,.15) * f0_13 +
    mat4(.06,.33,.11,.32,-.72,-1.22,-.71,-.49,.21,.05,.19,.44,-.43,.21,-.01,.44) * f0_14 +
    mat4(.90,-.18,-.26,-.42,.05,.25,.10,.22,-.20,-.86,.81,.45,-.10,-.03,.07,.27) * f0_15 + vec4(.01,.35,.03,.33));
    vec4 f1_12 = relu(
    mat4(-.04,.42,-.01,.30,-.07,-.15,-.25,-.42,.24,.25,-.10,.15,-.27,-.02,.07,.89) * f0_0 +
    mat4(.10,.33,.12,-.03,-.13,-.01,-.24,-.77,.22,.08,.11,.47,-.17,-.59,.03,.46) * f0_1 +
    mat4(.14,-.15,.32,.14,-.24,-.62,-.06,.45,.12,-.06,.29,.33,.30,.28,.09,.15) * f0_2 +
    mat4(1.21,.29,-.89,-1.47,-.42,.50,-.31,-.77,.23,.01,.16,.34,.22,.00,-.22,-1.18) * f0_3 +
    mat4(-.01,-.00,-1.01,-.20,-.00,-.20,-.14,.37,.14,-.24,.23,.39,.50,.36,-.45,-1.82) * f0_4 +
    mat4(-.40,-.37,.06,.08,-.50,.43,-.49,-.60,-.06,-.76,.09,-.38,-.53,.34,-.07,-1.80) * f0_5 +
    mat4(-.09,-.39,-.55,-.82,-.03,.28,-.38,-1.27,-.31,.86,-.64,-1.45,.38,.58,.05,-.52) * f0_6 +
    mat4(.02,.36,-.23,.04,.64,.30,-.36,-.67,.38,.42,-.14,-1.21,-.49,.16,.19,.12) * f0_7 +
    mat4(.06,.95,-1.42,-.06,.27,.19,.23,.46,-.23,.57,-1.01,.19,.13,.65,-.37,-.79) * f0_8 +
    mat4(-.03,-.34,.51,.04,-.09,.03,-.00,.10,-1.35,-.34,.09,.76,-.03,.92,-.40,-.68) * f0_9 +
    mat4(.10,.39,.16,-.08,-.38,.88,-.14,-.44,-.91,.77,-.32,-1.36,-.07,.21,-.08,-.03) * f0_10 +
    mat4(-.09,-.22,-.16,-.79,-.14,.07,.34,-.08,-.03,.17,-.04,.50,.23,-.78,-.11,-.69) * f0_11 +
    mat4(.11,-.30,-.03,.30,-.68,.29,-.65,-1.78,.33,-.56,-.11,-.48,.65,.99,-.33,-1.30) * f0_12 +
    mat4(-.73,-.27,1.26,.67,.02,-.61,-.19,-.48,.22,.27,-.18,-.08,.09,-.29,.18,-.10) * f0_13 +
    mat4(-.07,-.11,.01,.17,.69,.16,.42,-1.10,.00,.00,.12,.27,-.08,-.18,-.02,.17) * f0_14 +
    mat4(.04,.21,-.29,-1.03,-.15,-.16,.17,.22,.43,-1.23,.05,.08,-.06,.07,.02,-.09) * f0_15 + vec4(-.17,-.36,-.06,.10));
    vec4 f1_13 = relu(
    mat4(.50,-.13,-.03,-.62,-.15,-.10,.83,-.28,.11,.16,.21,.02,-.09,-.17,-.04,.95) * f0_0 +
    mat4(-.14,-.05,.18,-1.88,-.55,.54,.31,.06,-.36,-.09,-.15,-.23,-.71,-.14,-.79,.09) * f0_1 +
    mat4(-.09,-.14,.12,.36,.14,-.09,.13,-.36,-.02,-.09,-.15,.30,-.08,.16,-.11,-.51) * f0_2 +
    mat4(-.12,-.11,.59,-.26,-.82,.26,-.21,.01,-.16,.31,-.06,-.28,-.72,.38,1.07,-1.65) * f0_3 +
    mat4(-.47,.51,-.22,-.77,-.24,.17,-.10,-.79,-.07,-.14,.22,.24,.70,.54,-.40,.82) * f0_4 +
    mat4(-.21,-.55,-.98,.05,.95,-.05,.37,-.75,-.03,-.34,-.02,-.14,.31,.58,.06,.11) * f0_5 +
    mat4(.68,.19,.15,-.00,.83,.43,.86,1.34,.85,.89,.07,-.52,.01,.15,.03,-.01) * f0_6 +
    mat4(.59,-.04,-.04,.24,.45,.63,.36,-.94,-.06,.34,1.29,-.98,-.66,.12,-.12,-.28) * f0_7 +
    mat4(.91,.12,1.69,-.58,-.39,.08,-.23,.20,.97,-.45,.62,.17,.76,.16,-.15,.17) * f0_8 +
    mat4(.57,-.14,-.15,-.36,.14,-.23,-.23,-.77,.21,-.35,-.31,.55,.76,.20,.48,.49) * f0_9 +
    mat4(-.16,.05,.84,.40,-.21,-.42,.37,-4.56,.59,1.54,.45,-2.42,.01,-.24,-.41,-.17) * f0_10 +
    mat4(-.10,.06,.39,-.20,-.44,.09,-.52,-.04,-.23,.07,.22,-.34,.26,.27,-.40,-.15) * f0_11 +
    mat4(-.46,-.05,-.43,.05,1.00,.59,.52,-.02,.68,.06,.39,-.21,.03,.37,.22,-1.77) * f0_12 +
    mat4(-.25,.14,.67,-.11,.94,.10,-.37,-.99,-.33,-.04,-.13,-1.46,-.37,.10,.17,-.51) * f0_13 +
    mat4(.23,-.19,-.24,.27,.15,1.51,-.21,-.20,-.02,-.21,-.01,-1.25,-.27,-.01,-.06,.17) * f0_14 +
    mat4(1.99,-.24,1.36,.07,-.09,-.20,.05,.44,.26,.32,1.15,-.21,.12,-.21,-.04,.09) * f0_15 + vec4(-.33,-.11,-.42,.36));
    vec4 f1_14 = relu(
    mat4(.02,-.00,-.10,.08,-.14,1.39,.05,-.79,.31,.30,.13,.06,.25,-1.09,-.41,-.60) * f0_0 +
    mat4(.49,-.27,.15,-.06,.38,-.92,.04,.22,-.95,-.95,-1.60,.04,-.70,-.30,.38,-.43) * f0_1 +
    mat4(.48,.14,-.55,.42,-.02,-.41,.02,.12,-.02,.63,-.07,.10,-.41,.63,.07,.07) * f0_2 +
    mat4(.35,-.17,-.44,.67,-1.04,-.15,.26,.67,.17,-1.02,.07,-.31,.30,-.35,-.05,-.41) * f0_3 +
    mat4(-.34,.27,-.83,.86,-.16,-1.34,-.28,-.01,.06,-.35,-.21,-.21,.18,-.41,.80,.24) * f0_4 +
    mat4(-.40,-.76,.08,-.43,.50,.57,-.72,1.35,-.61,.51,.48,.00,-.17,-2.08,-.16,.98) * f0_5 +
    mat4(-.08,-2.02,.68,.31,.60,-1.73,.03,.22,.09,-.79,-.35,-.43,-.12,-.02,-.61,-.13) * f0_6 +
    mat4(.04,-.84,.42,.06,-.41,.02,-.10,-.41,-1.94,-1.78,-.81,.20,-.01,.47,-.41,.13) * f0_7 +
    mat4(.31,-.69,.50,.07,.26,.01,-.18,.27,.54,.20,-.50,-.08,-.24,-.06,-.19,.60) * f0_8 +
    mat4(-.39,-.48,-.32,-.97,-.30,-.07,-.28,-.28,-.18,.40,.22,-.13,-.08,.12,-.60,.69) * f0_9 +
    mat4(.10,-.56,-.56,.55,.32,-.38,.35,-.05,.39,.67,.48,.37,.43,-.69,-1.10,.06) * f0_10 +
    mat4(.35,-.13,-.05,-.08,.01,-.37,.44,-.43,.08,-.03,-.91,-.48,.28,-2.01,-.54,.50) * f0_11 +
    mat4(-.21,-.28,-.38,.14,-1.30,-2.11,.58,-1.08,-.14,-.04,-.38,.33,.22,.10,-.67,.66) * f0_12 +
    mat4(-.19,.31,.44,.05,-.42,-1.67,-.19,-.30,-1.25,-.29,.03,-.13,.15,-.40,.04,.05) * f0_13 +
    mat4(-.10,.26,-.19,.23,-1.09,2.34,-.17,.87,-.76,.02,-.19,.01,.20,-1.10,-.37,.20) * f0_14 +
    mat4(-.73,.81,1.14,-2.79,-.25,-.37,.03,.20,-1.48,.09,.31,.19,-.44,.48,-.12,.17) * f0_15 + vec4(.15,.10,.14,-.12));
    vec4 f1_15 = relu(
    mat4(.09,-.07,-.19,-.17,-1.30,-.63,-.28,1.27,-.08,-1.35,.09,-.16,.40,.21,.04,-.18) * f0_0 +
    mat4(.25,.14,.23,.01,-.22,.29,-.05,.10,.47,-.08,-.01,-.10,.47,-.86,.22,-.26) * f0_1 +
    mat4(.09,.47,.27,.43,.30,-.01,.09,.20,.49,-.46,.19,-.56,-.80,-.23,.10,-.60) * f0_2 +
    mat4(-.57,-.39,.04,.15,-.28,.01,-.28,.07,.47,-.29,.31,-.30,-1.79,-.65,-.88,.73) * f0_3 +
    mat4(-2.42,.13,-.55,-.06,.07,.03,.05,.25,.52,-1.21,.22,-.13,-1.60,.88,-.55,-.25) * f0_4 +
    mat4(.25,-.10,.15,-.24,-1.46,-.05,-.96,-.03,.17,-.29,-.37,.03,-2.22,.35,-.05,.85) * f0_5 +
    mat4(-1.13,-.05,-.57,.19,-1.01,-.48,-.88,.05,-.55,-.17,-.78,.24,-.97,-.81,-.23,.16) * f0_6 +
    mat4(-.74,-.78,-.55,.32,-.65,-.24,-.73,-.30,-1.21,-2.00,-.68,.74,.17,-.15,-.01,-.04) * f0_7 +
    mat4(-1.87,-.96,-.43,.25,.18,.36,-.28,-.31,.64,1.42,-.42,1.05,-.88,-.94,-.30,-.38) * f0_8 +
    mat4(.50,-.41,.28,-.72,.33,-.24,.14,-.13,.43,.05,-.02,-.48,-.01,-1.88,.03,-.57) * f0_9 +
    mat4(.69,-.98,.25,.03,.05,-.01,-.23,.42,-1.76,.76,-.44,.24,-.41,-.36,-.33,.40) * f0_10 +
    mat4(-.06,-1.51,-.53,-.49,.35,-.75,.44,-.03,.09,-.12,.00,.05,-.50,-.18,-.18,.28) * f0_11 +
    mat4(-.23,.42,-.07,-.32,-1.70,-.49,-.46,.12,-.76,.65,-.65,.08,-.94,.04,-.71,-.64) * f0_12 +
    mat4(-.08,.54,.95,-.53,-.80,.23,-.30,-.43,-.25,-.83,-.02,-.17,.46,.57,.24,-.25) * f0_13 +
    mat4(.09,.39,.01,.13,-3.41,-.64,-.95,1.28,.10,-.40,.15,.41,.44,-.22,-.09,.20) * f0_14 +
    mat4(-1.88,.64,-.53,.27,.02,.19,-.09,.21,-.46,-.45,.44,1.05,.03,.37,-.08,.43) * f0_15 + vec4(-.00,.27,.01,-.25));
    
    float out0 = dot(f1_0, vec4(.10,.11,.37,-.37)) + dot(f1_1, vec4(.44,.06,.28,-.04)) + dot(f1_2, vec4(.03,-.30,.11,.69)) + dot(f1_3, vec4(.10,.14,-.22,.17)) + dot(f1_4, vec4(-.54,-.43,-.31,-.17)) + dot(f1_5, vec4(-.01,-.25,.09,.04)) + dot(f1_6, vec4(.27,.77,.03,.27)) + dot(f1_7, vec4(-.10,-.44,.90,-.02)) + dot(f1_8, vec4(.76,.13,.10,-.08)) + dot(f1_9, vec4(.14,.24,.10,-.50)) + dot(f1_10, vec4(-.00,-.01,-.20,-.46)) + dot(f1_11, vec4(-.23,-.03,-.17,-.14)) + dot(f1_12, vec4(.33,-.21,-.00,.03)) + dot(f1_13, vec4(-.03,-.17,-.03,-.09)) + dot(f1_14, vec4(-.24,-.33,-.60,.03)) + dot(f1_15, vec4(-.01,-.38,-.00,-.02)) + .19;
    float out1 = dot(f1_0, vec4(.03,.05,.15,-.28)) + dot(f1_1, vec4(.35,-.08,.01,.00)) + dot(f1_2, vec4(.04,-.26,-.03,.38)) + dot(f1_3, vec4(-.01,-.05,-.30,.05)) + dot(f1_4, vec4(-.49,-.32,-.29,-.24)) + dot(f1_5, vec4(-.00,-.45,.02,.09)) + dot(f1_6, vec4(.21,.82,.07,.06)) + dot(f1_7, vec4(.06,-.45,.50,-.13)) + dot(f1_8, vec4(.44,.07,-.06,-.01)) + dot(f1_9, vec4(.05,.13,.07,-.39)) + dot(f1_10, vec4(-.01,-.03,-.02,-.42)) + dot(f1_11, vec4(-.26,.08,.03,-.12)) + dot(f1_12, vec4(-.09,.02,.02,.02)) + dot(f1_13, vec4(.03,-.09,-.03,-.16)) + dot(f1_14, vec4(-.33,-.39,-.45,-.00)) + dot(f1_15, vec4(-.02,-.08,.01,.03)) + .09;
    float out2 = dot(f1_0, vec4(-.04,.12,-.38,-.12)) + dot(f1_1, vec4(.19,.08,-.34,.01)) + dot(f1_2, vec4(-.06,-.15,-.11,.04)) + dot(f1_3, vec4(-.29,.12,-.46,-.43)) + dot(f1_4, vec4(-.39,-.23,-.24,-.26)) + dot(f1_5, vec4(.08,-.45,-.07,-.14)) + dot(f1_6, vec4(.16,1.00,.10,-.15)) + dot(f1_7, vec4(.08,-.35,-.09,-.10)) + dot(f1_8, vec4(-.46,.07,.05,.08)) + dot(f1_9, vec4(.16,-.14,-.03,-.15)) + dot(f1_10, vec4(.03,-.07,-.05,-.28)) + dot(f1_11, vec4(-.26,-.13,.58,-.05)) + dot(f1_12, vec4(-.07,.17,-.00,-.08)) + dot(f1_13, vec4(-.09,-.19,-.00,-.30)) + dot(f1_14, vec4(-.49,-.41,-.20,-.20)) + dot(f1_15, vec4(-.01,.70,.01,-.04)) + -.19;
    float out3 = dot(f1_0, vec4(.02,.06,-.94,.70)) + dot(f1_1, vec4(-1.20,.33,.03,3.00)) + dot(f1_2, vec4(.38,3.39,1.60,-.50)) + dot(f1_3, vec4(-.50,.03,-.55,-1.76)) + dot(f1_4, vec4(.26,-.08,.05,.26)) + dot(f1_5, vec4(1.13,.27,.50,.41)) + dot(f1_6, vec4(.87,-.31,.50,.23)) + dot(f1_7, vec4(1.14,-.05,-.75,-.52)) + dot(f1_8, vec4(-.66,.80,.62,-.55)) + dot(f1_9, vec4(-.04,-1.23,.88,.14)) + dot(f1_10, vec4(1.17,.09,-1.66,-.34)) + dot(f1_11, vec4(-.42,.85,-.84,2.14)) + dot(f1_12, vec4(-.66,-1.06,1.01,1.80)) + dot(f1_13, vec4(-1.23,-.16,-1.08,-2.75)) + dot(f1_14, vec4(-.20,2.02,-.42,-.51)) + dot(f1_15, vec4(2.30,-.58,1.07,-1.34)) + .17;
    return vec4(out0, out1, out2, out3);
}

vec3 rotate(vec3 p) {
    return vec3(p.x, -p.z, p.y);
}

//// set camera: ro - camera position, ta - camera lookat, cr - camera rotation angle
mat3 setCamera( in vec3 ro, in vec3 ta, float cr )
{
	vec3 cw = normalize(ta-ro);
	vec3 cp = vec3(sin(cr), cos(cr),0.0);
	vec3 cu = normalize( cross(cw,cp) );
	vec3 cv =          ( cross(cu,cw) );
    return mat3( cu, cv, cw );
}
float rand(vec2 co) {
    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);
}

/////////////////////////////////////////////////////
//// You are asked to implement the front-to-back volumetric ray tracing algorithm for NeRF to accummulate colors along each ray.
//// You may reuse most of the code from A2a, however, you would use your trained NeRF model to predict the RGB and sigma value.
//// To call your trained NeRF model, call queryNetwork(vec3 p)
//// We have given you a default hotdog model in hotdog.txt, replace that with your own NeRF.
//// Caution: After calling your NeRF, you should use Sigmoid for RGB and ReLU for sigma, as you do in your pytorch code.
//// Sigmoid and ReLU have been defined for you, simply call sigmoid() or relu().
/////////////////////////////////////////////////////

//// ro - ray origin, rd - ray direction, 
//// near - near bound of t, far - far bound of t, 
//// n_samples - number of samples between near and far
vec4 volumeRendering(vec3 ro, vec3 rd, float near, float far, int n_samples, vec2 fragCoord) 
{
    float stepSize = (far - near) / float(n_samples);                               //// step size of each sample

    //// color and transmittance
    vec3 color = vec3(0.0);                                                         //// accumulated color
    float transmittance = 1.0;                                                      //// transmittance

    //// ray marching loop
    for (int i = 0; i < n_samples; i++) {
        float t = near + stepSize * (float(i) + rand(fragCoord));                   //// t value along the ray
        vec3 p = ro + t * rd; // Compute 3D sample position

        //// your implementation starts
        p = rotate(p);
        vec4 f0 = queryNetwork(p);
        vec3 c = sigmoid(f0.rgb);
        float sigma = relu(f0.a);
        float alpha = 1.0 - exp(-sigma * stepSize);
        color += c * alpha * transmittance;
        transmittance *= (1.0 - alpha);
        //// your implementation ends

        //// early termination if opacity is high
        if (transmittance < 0.001) break;
    }
     
    //// return color and transmittance 
    return vec4(color, 1.0);                                   
}



void mainImage(out vec4 fragColor, in vec2 fragCoord)
{
    //// normalize fragment coordinates to [-0.5, 0.5] range
    vec2 uv = (fragCoord - 0.5 * iResolution.xy) / iResolution.y;

    //// camera 
    float angle = 0.5 * iTime;                                                  //// camera angle
    vec3 ta = vec3(0.0, 0.0, 0.0);                                              //// object center
    float radius = 3.5;                                                         //// camera rotation
    float height = 2.2;                                                         //// camera height
    vec3 ro = ta + vec3(radius * cos(angle), height, radius * sin(angle));      //// camera position
    mat3 ca = setCamera(ro, ta, 0.0);                                           //// camera matrix


    //// ray
    vec3 rd = ca * normalize(vec3(uv, 1.0));                                    //// ray direction
    float near = 2.0;                                                           //// near bound
    float far = 6.0;                                                            //// far bound
    int n_samples = 64;                                                         //// number of samples along each ray

    //// final output color
    fragColor = volumeRendering(ro, rd, near, far, n_samples, fragCoord);                  //// volumetric ray marching
}

void main()
{
    mainImage(gl_FragColor, gl_FragCoord.xy);
}